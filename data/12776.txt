By BRUCE SHIPKOWSKI

TRENTON, N.J. — A registered sex offender who barricaded himself for days in a home with his girlfriend's three children was shot to death Sunday as police rescued the captives and recovered the bodies of their mother and another sibling, authorities said.

Police officers initially went to the South Trenton home Friday afternoon after a relative of 44-year-old Carmelita Stevens said she hadn't spoken to her in weeks and was worried, authorities said at a news conference Sunday. Upon further investigation, authorities then discovered her children hadn't been to school in 12 days.

Officers entered the home through a rear door and smelled an odor consistent with that of a decomposing body, Trenton Police Director Ralph Rivera Jr. said. The officers also noticed maggots throughout the residence.

They found 38-year-old Gerald "Skip" Tyrone Murphy in an upstairs bedroom and he told them he was armed with a gun and explosives and had three children with him, Mercer County Prosecutor Joseph L. Bocchini Jr. said. Officers noticed one of the dead victims before they retreated from the second floor and rescued Stevens' 19-year-old son from the basement, who said he hadn't seen her or his siblings since about April 24.

Homes on the surrounding block were evacuated as a precaution, and police tape cordoned off the street in front of the house. A SWAT team was called, and an arson bomb unit was also on the scene. Police said Murphy could be seen from a window holding a black handgun.

Police remained in contact with Murphy throughout the 37-hour-long standoff and passed food into the home through an upstairs window, state police Col. Rick Fuentes said. Murphy kept the captives with him inside the roughly 10-foot-by-11-foot bedroom throughout the standoff, authorities said.

Officers stormed the home at around 3:45 a.m. Sunday after noting Murphy's "deteriorating state of mind" and deciding it was necessary to enter to help ensure the captives survived, Fuentes said. An officer shot Murphy because he was threatening one of the children, he said.

Murphy was taken to a hospital and later died of his injuries. No law enforcement personnel were injured during the standoff or the confrontation with Murphy.

"This was a very complex matter, considering the space (where the hostages were) and that three children were involved," Fuentes said. "Our mission over those 37 hours was to save innocent lives."

Authorities found the bodies of Stevens and her 13-year-old son in separate bedrooms. Stevens' body was in an advanced state of decomposition, and police said she appeared to have died two weeks ago. Police didn't say which of the bodies they had seen inside the home Friday afternoon.

Three of Stevens' children — an 18-year-old woman, a 16-year-old girl and a 4-year-old boy — were rescued and taken to a medical center for evaluation and treatment. Murphy had abused and assaulted the captives, Bocchini said.

Murphy and Stevens had been dating for a few months, and both lived in the house, police said. He was not the father of any of her children.

Authorities wouldn't comment on a possible motive or say how the victims died, citing the ongoing investigation. They also would not say whether any bombs or other explosives were recovered at the residence.

Murphy had a long criminal history including convictions for aggravated assault and criminal conspiracy, Bocchini said. He had previously been arrested for robbery and weapons offenses and child endangerment. He also had an arrest warrant in Pennsylvania for failing to register as a sex offender.

Homes on the surrounding block were evacuated as a precaution while the standoff was taking place, and police tape cordoned off the street in front of the house and nearby homes. Bocchini thanked residents for their cooperation during the course of the standoff.