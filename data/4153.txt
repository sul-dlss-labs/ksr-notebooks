It had been a tense 20-hour standoff and a full day of emotional negotiations with a carpenter who abducted his 9-year-old son at gunpoint Tuesday evening and holed up in his Alexandria home.

But then Lewis W. Barber, 48, suddenly walked out onto his front porch yesterday afternoon and waved his gun at police. They shot him and he collapsed. Special operations officers rushed into the house and within minutes had rescued Barber's son, Phillip, and returned him to his mother. Lewis Barber was pronounced dead at 5:15 p.m.

"He forced their hand," said Capt. John Crawford, an Alexandria police spokesman. "It's an unfortunate thing it ended tragically for that family, but the officer had no other choice."

The standoff began shortly after 8:30 p.m. Tuesday, when Barber snatched his son at gunpoint from his estranged wife on King Street in Old Town Alexandria after learning that she was going to leave him.

All day in the tightly knit Del Ray community, no one could quite believe that Barber, a fixture along West Wyatt Avenue for years, was the one who news broadcasts were saying had kidnapped his son. Dazed neighbors in Del Ray -- once a working-class section of Alexandria that in recent years has become a trendy home to professional families -- skirted the police barricades blocking several neighborhood streets. Parents worriedly escorted their children to the nearby elementary school, greeted by School Board member Arthur E. Schmalz, who just wanted to make sure everyone was calm.

Friends described Barber as a quiet man who had strong views and held fast to them. Nora Partlow, owner of St. Elmo's Coffee Pub, the local gathering place, said she had known Barber for more than 20 years, back in the days when she was bartending at the old Snuggery Cafe.

"He was a devoted father," she said as shocked neighbors gathered to share news and disbelief over coffee and muffins. "And not seeing his son -- well, he felt that just wasn't right."

Police worked through the night and day to end the standoff. Four blocks were immediately cordoned off, trapping some residents who did not want to leave their homes until a police escort could ferry them out later. Neighbors spent the night listening to police sirens and hostage negotiators bark at Barber's home through a bullhorn as they tried to establish contact. In the morning, police were able to establish a link over a cell phone, but communication was sporadic and emotional, police said.

Just minutes before a loud boom resonated through the tranquil neighborhood, Partlow and other friends of Barber's had been trying to round up a mediation lawyer to send to help him out. "We were thinking, maybe if he had someone he could talk to who knew him . . . "

Barber's estranged wife, Robin, had gone to court Friday for a protective order to keep her husband away from her and her son, according to court records. She planned to leave town the next day and stated that her husband did not know she was going. She said she feared for their safety in a home that contained guns.

She described her husband as "a very quiet man and very unpredictable," adding that he had a drinking problem. She told the court about an incident in 1998 when she planned to leave him and he allegedly went into their attic and fired two shots.

The protective order was granted, barring Lewis Barber from contact with his wife or his son. On Saturday, police accompanied Robin Barber to collect belongings at her home.