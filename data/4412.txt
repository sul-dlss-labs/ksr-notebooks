A man who died in police custody last month soon after officers shocked him with a Taser stun gun died of a cocaine overdose, not from the shock, the city medical examiner said yesterday.

Investigators had said that the man, Terrence L. Thomas, 35, might have swallowed crack cocaine before detectives arrested him early on the morning of July 27.

After his arrest, in a holding cell at the 105th Precinct station house, Mr. Thomas became unruly and refused medical attention, the police said, prompting officers to shock him with the Taser. Less than an hour later, he was pronounced dead at Queens Hospital Center in Jamaica.

A spokeswoman for the medical examiner said that the Taser did not cause or contribute to Mr. Thomas's death, which was ruled an accident.