UPDATED 5:40 p.m.: Brandon has a criminal record dating back to March 2002 when he was charged with felony burglary at age 19, according to Gazette archives. He pleaded not guilty to being part of a trio accused of running a sophisticated burglary ring.

In January 2003, he pleaded not guilty to felony robbery and misdemeanor charges of obstructing an officer and resisting arrest, after being accused of shoplifting, threatening a store employee with a knife and attempting to flee police, Gazette records show.

The state Department of Corrections website lists sentencings for Brandon for deceptive practices in July 2003, robbery in March 2006 and failure to register as a violent offender in September 2006.

In October 2011, Brandon was wanted by the U.S. Marshals Service's Montana Violent Offender Task Force based on a warrant for violation of his probation. Marshals apprehended Brandon, according to Gazette archives, but on April 29, Brandon again was wanted by the Task Force for probation violations.

UPDATED 3:30 p.m.: The man fatally shot by police early Thursday has been identified as Michael Brandon, 29, of Billings. An autopsy is being conducted.

Police shot and killed a man who twice fired on officers early Thursday during "a running gun battle" through downtown, "two situations of close-quarters combat," Chief Rich St. John said.

The three officers involved in the shooting -- 11-year veteran Sgt. Shawn Mayo, two-year veteran Officer Mark Snyder and two-year veteran Officer Mike Yarina -- were placed on paid administrative leave, which is standard procedure in the investigation of officer-involved shootings.

The name of the dead man was being withheld later Thursday while family members were notified.

The incident began at about 3:30 a.m., when a patrol officer recognized a passenger in a car in the lot of the Holiday gas station, 2620 Sixth Ave. N., who was wanted on a felony parole violation warrant.

Lt. Kevin Iffland said the man was convicted of robbery in 2003.

The man got out of the car and went into the store as a second officer arrived and the two officers, Sgt. Shawn Finnegan and Officer Steve Hallam, attempted to arrest him.

"The suspect runs from the officers and at some point pulled a semi-automatic handgun and fired several shots at the officers," St. John said in an 8 a.m. news conference at City Hall. "Fortunately, the rounds missed the officers, the clerk and several patrons."

The man, who St. John said was a 29-year-old Billings man, then ran to the west across North 27th Street and through the parking lot of the US Bank drive-up facility on Sixth Avenue North.

"The suspect fired several more shots at the officers while running away," St. John said.

The officers did not return fire at that point, which the chief said "exemplifies their professionalism and their discipline," because there were civilians nearby.

Police, Yellowstone County sheriff's officers and Montana State University Billings police searched the area for about 45 minutes, using night vision equipment and search dogs. The sheriff's office handled service calls throughout the city while police searched for the shooter.

Officers learned from a motel employee that the man had locked himself in a bathroom at the Dude Rancher Lodge, two blocks away at 415 N. 29th St.

At 4:16 a.m., officers located the man in a bathroom near the lobby.

"Although we continue to investigate exactly what transpired, it appears that the suspect fired several rounds through the door, then came out of the bathroom and charged the officers while shooting," St. John said.

The officers in the building shot and killed the man, who fired on them first, he said.

An ambulance crew from American Medical Response came in about a minute later and took the man to St. Vincent Healthcare at 4:30 a.m.

St. John said he did not know if the man died at the lodge, in the ambulance or at the hospital.

No other injuries, to officers or anyone else, were reported. Initial reports that an officer had been struck by gunfire while wearing a bulletproof vest were unfounded, officials said later.

Police blocked off a large area of downtown, posting patrol cars and officers on the north- and southbound streets from North 27th to North 30th streets south of Sixth North during the search.

St. John said at 5:30 a.m. that because the crime scene covers such a large area, the investigation was likely to take a while.

Harvey Bybee owns the Josephine Bed and Breakfast, across the street from the Dude Rancher, and said he heard gunshots from the incident.

"I thought somebody was maybe banging around in the construction area across the street," he said. "I heard that and that's when I came outside and saw all the cops here."

The chief praised the response of the entire department -- at one point there were two full shifts and the entire detective division working -- and said the officers directly involved did an exemplary job.

"Uncommon valor is a very common thing here," he said. "You can't teach that. You can't teach somebody to be courageous when somebody's charging at you and firing a handgun."

By sunrise, officers had put up yellow crime scene tape along much of the area from the Holiday to the Dude Rancher and were searching for evidence. Tape surrounded the Holiday and US Bank properties, North 29th was barricaded from the Dude Rancher to Fourth Avenue North and officers blocked the southbound traffic lane on North Broadway.

By 11:30 a.m., all of those areas had been reopened except for North 29th. Iffland said detectives expected to be there for most of the day.

As of 2 p.m., the department's CSI truck remained parked outside the building and the street was barricaded while detectives investigated.

The department's crime scene investigation truck arrived on scene shortly before 5 a.m. The plan was to begin at the Holiday station and for detectives to work their way west to the motel.

St. John said the scene at the Dude Rancher was "extremely complex" and described the incident as something new to the department.

"An incident like this, we've never had one (exactly) like this, with a running gun battle through downtown," he said.

Counseling, debriefing sessions and other resources will be made available to the officers involved in the shooting.

A coroner's inquest, which is required by law any time a law enforcement officer is involved in a death, will be set later to review the shooting.

Yellowstone County Attorney Scott Twito said the complexity of the investigation into Thursday's shooting means that the inquest may not happen soon.