An undercover narcotics detective who minutes before had bought $30 worth of heroin in a buy-and-bust operation in Brooklyn yesterday shot and killed a man who tried to rob him, the police said.

The police said the man confronted the detective at 11:50 a.m. in front of 371 Troutman Street, in Bushwick, about half a block from where the detective had just bought three $10 glassine envelopes of heroin.

The man, identified as Reynaldo Colon, 33, of Ridgewood, Queens, approached the detective with a folding Leatherman, a metal-colored multipurpose tool, and said, ''Give me the decks,'' using street slang to refer to the small glassine packages of heroin, a senior police official said.

The detective responded by firing four shots, a senior police official said. At least three bullets hit the man in the chest and torso. He was pronounced dead at the scene.