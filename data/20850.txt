A 17-year-old student smuggled guns into his school outside a small town north of here on Monday, took two hostages and then killed himself, law enforcement officials said today.

The student, Chris Buschbacher, was despondent about a recent romantic breakup and legal troubles, the officials said.

The incident occurred near Caro, a farming town of 4,100 people about 75 miles north of Detroit. The hostages, a 15-year-old female student and a 48-year-old teacher, were released -- one in exchange for a pack of cigarettes -- before Mr. Buschbacher shot himself with a 20-gauge shotgun. No one else was harmed.

Mr. Buschbacher fired only one other shot, into a wall.

The Caro schools superintendent, Dennis Anderson, said officials believed that Mr. Buschbacher left the school during a break and then re-entered, with the shotgun and a .22-caliber rifle hidden in a duffel bag, through a rear door that had been propped open.