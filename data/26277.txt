St. Clair Shores — A man who killed a woman and then committed suicide during a 28-hour standoff with police failed to register as a sex offender after molesting a 4-year-old girl in 2006 and could have faced years in prison for violating his probation.

Tom Ihlenfeldt, who was found dead Saturday along with Carol Baur in their home after the standoff, had pleaded no contest to second-degree criminal sexual conduct in 2007, according to court records and a state official. A no-contest plea has the same legal effect as a guilty plea but does not constitute an admission of guilt.

Ihlenfeldt, who was sentenced to four years' probation, failed to register his address for inclusion on the state's Sex Offender Registry — but the late Macomb Circuit Judge Donald G. Miller decided that wasn't a probation violation, said Michigan Department of Corrections spokesman Chris Gautz.

Had the judge, who died in January, ruled Ihlenfeldt in violation, it would have negated the plea deal, and, under the agreement's terms, Ihlenfeldt would have been recharged with second-degree criminal sexual conduct, which carries a penalty of up to 15 years in prison.

Instead, Ihlenfeldt moved to a house on St. Margaret Street months after agreeing to the plea deal, and, neighbors said, became a nuisance for years.

The problems escalated on the Fourth of July, when police say Ihlenfeldt, 58, became angered over neighbors' use of fireworks. He fired a rifle, wounding two people. He then opened fire on officers who responded to a 911 call, police said.

Police officials say Ihlenfeldt barricaded himself inside the house for more than 28 hours, during which he killed Baur, 60, and fatally shot himself.

After the lengthy standoff, officers entered the house on St. Margaret at 2:30 a.m. Saturday, and found Ihlenfeldt and Baur dead in the basement, according to a St. Clair Shores police press release.

"Although the official autopsy reports have not been obtained, it appears that Baur died from multiple gunshot wounds and that Ihlenfeldt died from a single self-inflicted gunshot wound," the release said.

The incident wasn't Ihlenfeldt's first contact with police. On Sept. 15, 2006, he molested the girl and was charged with first-degree criminal sexual conduct, Gautz said.

"He was watching this girl, babysitting her, and giving her a bath," Gautz said.

The girl told a relative, who called St. Clair Shores police, Gautz said.

Ihlenfeldt was charged with first-degree criminal sexual conduct. His trial began March 16, 2007, before Miller. Three days later, court records show the case was declared a mistrial because of a hung jury.

The day the mistrial was declared, Macomb County prosecutors filed second-degree criminal sexual conduct charges against Ihlenfeldt.

Court records show Ihlenfeldt cut a deal with Macomb County prosecutors in July 2007 to plead guilty to second-degree criminal sexual conduct and receive four years of probation, with the understanding that if he violated his probation, the plea deal would be vacated.

Per the agreement, "if he successfully completed the probation, the charges would be dismissed," Gautz said. "He was also required to register as a sex offender, and go to counseling."

In July 2008, Gautz said corrections officials reported that Ihlenfeldt had failed to provide his address to the state's Sex Offender registry, and an arrest warrant was issued.

"I don't know why the judge didn't find that in violation," Gautz said. "It's up to a judge to determine what a violation is. Some might say anything you do could be a violation; others just want to see more serious things.

"Certainly, if you're not following the rules, we'll take the case to a judge and let them know," Gautz said. "But from there, it's up to the court to decide whether they'll violate them."

In July 2010, Gautz said Ihlenfeldt again violated the terms of the plea deal.

"The people who lived near him, who were potential witnesses, said he had contact with them, which is a violation," Gautz said. "He was advised he was in violation, and the judge ordered him to pay a $100 fine and eight hours of community service, or two days in jail.

"I don't know what happened to the case after that, because his probation term ended on Aug. 26, 2010," Gautz said.

St. Clair Shores police Lt. James Fraser said Ihlenfeldt's previous crime was not thought to be related to the recent incident.

Neighbor Channita Jackson told The Detroit News she has had problems with Ihlenfeldt for years, filing more than 20 police reports against him.

Jackson said Ihlenfeldt became angry after her relatives gathered at her house for a Fourth of July party, and some began setting off sparklers. She said Ihlenfeldt shined a laser beam at them.

Then, police say, Ihlenfeldt began firing his rifle. Jackson said her 62-year-old mother and 12-year-old niece were shot in the bicep and leg, respectively. Police said the injuries were non-life threatening, and Jackson confirmed both were treated at a local hospital.

Ihlenfeldt also "was firing at our officers," Fraser said. After several hours, and attempts to extricate Ihlenfeldt from the house that included deploying smoke bombs, police sent a Michigan State Police robot into the house to determine his location.

The robot "determined that Baur was in fact inside the residence and that she was deceased," the police press release said. "It was also determined that Ihlenfeldt had taken up an offensive position in the basement.

"As the robot attempted to better identify Ihlenfeldt’s exact location in the basement, he fired several rounds which in turn completely disabled the robot," the release said. "Ihlenfeldt also fired multiple rounds from the residence toward the direction of officers with a high powered rifle."

Macomb County Medical Examiner Daniel Spitz told The News Monday that his office has finished autopsies and informed police of the findings. Fraser said the official autopsy document is expected "in a few weeks."

Oralandar Brand-Williams contributed.