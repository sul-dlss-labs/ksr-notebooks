An undercover officer posing as a gun buyer shot and killed a gun trafficker in Brooklyn on Wednesday night after the man pointed a gun at him, the police said.

The shooting took place shortly before 8 p.m. in the Bushwick neighborhood, as the undercover officer was trying to buy six handguns from a man on the ground floor of 193 Knickerbocker Avenue with $4,200 in cash, the police said. At some point, a second man — an apparent accomplice of the gun trafficker — showed up and began a staged robbery, pointing a .380 caliber pistol at the trafficker. The man then turned the pistol on the undercover officer, who in turn fired three shots, striking the armed man an unknown number of times, said Paul J. Browne, the police department’s chief spokesman.

Mr. Browne said the wounded gunman then fled to the second floor of the building, where he collapsed and died. As the undercover officer backed out of the building and called for backup, the other man picked up the pistol and made his way to the building’s rooftop, where he tried to hide the weapon behind a plaster board, Mr. Browne said.

He was taken into custody and questioned late Wednesday night at a nearby precinct, where he made statements implicating himself, Mr. Browne said. The undercover officer survived, unharmed.