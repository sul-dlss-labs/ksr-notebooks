SAN JOSE — Prosecutors say a San Jose police sniper was justified when he fatally shot a mentally ill man who killed his ex-girlfriend’s parents at their Willow Glen home, held their young son hostage, and even taunted the woman about the slayings during his standoff with police.

The deadly May 3, 2017 encounter on Laura Ville Lane shook the serene Willow Glen community and was revealed to be the culmination of a string of violent and threatening behavior by 24-year-old Campbell resident Mirza Tatlic. Thursday, the Santa Clara County District Attorney’s Office released its formal 69-page report on the case.

“When a person, who has already murdered two defenseless people in their own home, thereafter points a loaded handgun at responding police, the police do not have to wait for that person to fire another shot before using lethal force,” Deputy District Attorney David Boyd said in the prosecutors’ report. “The person with the gun aimed toward police is an imminent threat to kill or disable them.”

Around 9 p.m. that night, authorities say Tatlic went to the home of 54-year-old Naren Prabhu, a vice president of engineering at Juniper Networks, and shot Prabhu moments after he opened the front door. Tatlic then shot Prabhu’s wife, 53-year-old Raynah Prabhu.

The couple’s 20-year-old son witnessed the shootings and ran outside to a neighbor’s home, where he called 911, and told police dispatchers that his 13-year-old brother was still in the home with Tatlic, police said.

A phalanx of police officers responded to the Prabhu home, and determined that Tatlic had dated the Prabhus’ daughter, and that she had filed a restraining order against him. Court records show that Tatlic’s own mother had done the same.

As Tatlic stalemated police while holed up in the home, he reportedly told police negotiators that he killed his ex-girlfriend’s parents to cause her pain as “payback” for the ending their relationship, a law-enforcement source told this news organization. He made a similar call to his ex-girlfriend, who was out-of-state at the time, telling her, “I killed your parents,” according to the report.

At some point during the standoff, Tatlic allowed the teen boy — who he had been using as a human shield — to leave the home, police said. Tatlic ignored orders to surrender and began pointing a handgun at officers preparing to enter.

Prosecutors say two snipers were preparing to open fire. Officer Jacob Morris fired, hitting Tatlic through a window. Tatlic was pronounced dead at the scene.

The shooting report released Thursday also noted that Morris was involved in another officer-involved shooting on Aug. 17, 2015, when he shot and killed Richard Jacquez, who was wanted in a homicide a few days earlier. Prosecutors cleared Morris of any wrongdoing, stating that Jacquez’s implication in a deadly shooting, where surveillance video showed him carrying a semiautomatic pistol, justified the shooting of fleeing suspect about to enter a home.

That shooting proved controversial because SJPD initially reported that Jacquez reached into his waistband, prompting Morris to open fire. The department later retracted the waistband claim, which Morris did not make. Jacquez’s family is pursuing a wrongful-death lawsuit against the police department and city.

At the time of the Willow Glen shootings, Tatlic was facing a felony assault charge in Massachusetts involving the victims’ daughter, and that he was wanted on an arrest warrant for violating her restraining order. He had been placed on a psychiatric hold two months earlier after threatening to overdose on painkillers authorities said.

Boyd said in the prosecutors’ report that Tatlic was an imminent threat given what he had done prior to police arriving.

“Everyone knew that the gun was real and that it worked because of the constant reminder of Mr. Prabhu’s lifeless body in the doorway,” he wrote. “When Tatlic extended his arm with the gun in hand toward the window with numerous officers down below, he presented an immediate threat of death or great bodily injury that had to be immediately neutralized.”