A two-hour police standoff with a man armed with a gun ended Wednesday evening in Millersburg when the man committed suicide, according to Harold Trego, a criminal investigator with the borough police department.

The man had a gun and barricaded himself inside his living room at 310 Market St. He called a friend who alerted authorities that the man was suicidal, according to Trego.

Trego added that the man suffered from legal, health and alcohol issues and was a longtime resident of the borough.

The standoff with police forced the closure of part of Market Street near the boroughâ€™s square.