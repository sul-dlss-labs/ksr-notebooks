Two undercover cops fatally shot a crook in Queens Saturday night after he pointed a pellet gun at them as they arrested a drug dealer, police sources said.

‘They’re cops, you idiot!” the drug dealer bellowed to Victor Santos, 42, who didn’t realizing that his two marks were actually plainclothes police officers involved in a drug buy-and-bust operation.

Authorities believe that Santos thought he had stumbled on a robbery in progress at Seneca and Gates avenues in Ridgewood at around 10:45 p.m. — and hoped to clean out all three men, sources said.

“He thinks he’s witnessing a drug [robbery] and thinks he’s going to take the proceeds from everyone,” said a police source, adding that Santos was known in the neighborhood for pulling heists.

Santos exited the livery car he was in as soon as he spotted alleged drug dealer Nolan Rivera, 39, and the two undercovers, ran toward the trio and raised his weapon at the officers as their backs were turned, police said.

The handcuffed dealer saw Santos pulling his realistic-looking weapon and yelled at him that he was waving a gun at law enforcement, not a pair of thugs, authorities said.

The detectives wheeled around to face Santos and came face to face with what they thought was a Glock semiautomatic pistol. The officers then squeezed off six shots and struck the seasoned robber three times in the torso and leg, cops said.

He was pronounced dead on arrival at nearby Wyckoff Heights Hospital.

Sources said Santos’ weapon was later discovered to be a Walther CP99 compressed-air pistol.

Departmental policy allows officers to fire their weapons if they fear imminent danger of death or serious injury, police said.

Witnesses said the undercovers — neither of whom had fired his weapon before — had their badges displayed during the lethal incident.

The dead man had 39 prior raps against him for charges that included assault, trespassing and robbery, and had just been released from prison in June after a six-month stint. He had 15 prison stays under his belt, with his first arrest dating back to 1987.

Rivera told investigators that he recognized Santos from the neighborhood but didn’t know him personally.

“I was watching ‘Law and Order: SVU’ and I heard four to five shots ring out,” said nearby resident David Treutly of the shooting. “When I went outside, there were eight to 10 plainclothes talking together, and at least 14 cop cars showed up. I saw the guy lying on the sidewalk. He was motionless when he was put into the ambulance.”

Rivera was taken to a local hospital for observation after allegedly ingesting a small amount of crack cocaine during the chaos, cops said.

He was eventually charged with sale of a controlled substance, tampering with evidence and possession of marijuana.

Several other cops who were stationed in a nearby building as backup for the buy-and-bust operation heard the shots and poured into the street to aid their partners, police said.

Additional reporting by C.J. Sullivan